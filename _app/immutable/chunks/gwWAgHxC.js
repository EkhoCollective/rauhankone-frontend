var at=Object.defineProperty;var nt=(t,e,i)=>e in t?at(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var y=(t,e,i)=>nt(t,typeof e!="symbol"?e+"":e,i);import{b as J,aC as P,d as K,g as W,h as E,az as ot,b2 as lt,b3 as ct,a5 as ut,b4 as ft,b5 as dt,b6 as pt,b7 as ht,y as vt,b8 as bt,b9 as gt,ba as _t,l as V,bb as mt,bc as wt,_ as At,bd as yt,be as St,U as Bt,bf as Et,bg as Ft,b0 as Mt,a4 as Ct}from"./g1kLeUxh.js";function Lt(t,e){var i=void 0,s;J(()=>{i!==(i=e())&&(s&&(P(s),s=null),i&&(s=K(()=>{W(()=>i(t))})))})}function Z(t){var e,i,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(i=Z(t[e]))&&(s&&(s+=" "),s+=i)}else for(i in t)t[i]&&(s&&(s+=" "),s+=i);return s}function It(){for(var t,e,i=0,s="",r=arguments.length;i<r;i++)(t=arguments[i])&&(e=Z(t))&&(s&&(s+=" "),s+=e);return s}function Ut(t){return typeof t=="object"?It(t):t??""}const q=[...` 	
\r\fÂ \v\uFEFF`];function kt(t,e,i){var s=t==null?"":""+t;if(e&&(s=s?s+" "+e:e),i){for(var r in i)if(i[r])s=s?s+" "+r:r;else if(s.length)for(var a=r.length,n=0;(n=s.indexOf(r,n))>=0;){var o=n+a;(n===0||q.includes(s[n-1]))&&(o===s.length||q.includes(s[o]))?s=(n===0?"":s.substring(0,n))+s.substring(o+1):n=o}}return s===""?null:s}function Q(t,e=!1){var i=e?" !important;":";",s="";for(var r in t){var a=t[r];a!=null&&a!==""&&(s+=" "+r+": "+a+i)}return s}function T(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Dt(t,e){if(e){var i="",s,r;if(Array.isArray(e)?(s=e[0],r=e[1]):s=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,n=0,o=!1,d=[];s&&d.push(...Object.keys(s).map(T)),r&&d.push(...Object.keys(r).map(T));var l=0,g=-1;const p=t.length;for(var h=0;h<p;h++){var u=t[h];if(o?u==="/"&&t[h-1]==="*"&&(o=!1):a?a===u&&(a=!1):u==="/"&&t[h+1]==="*"?o=!0:u==='"'||u==="'"?a=u:u==="("?n++:u===")"&&n--,!o&&a===!1&&n===0){if(u===":"&&g===-1)g=h;else if(u===";"||h===p-1){if(g!==-1){var A=T(t.substring(l,g).trim());if(!d.includes(A)){u!==";"&&h++;var m=t.substring(l,h).trim();i+=" "+m+";"}}l=h+1,g=-1}}}}return s&&(i+=Q(s)),r&&(i+=Q(r,!0)),i=i.trim(),i===""?null:i}return t==null?null:String(t)}function Ot(t,e,i,s,r,a){var n=t.__className;if(E||n!==i||n===void 0){var o=kt(i,s,a);(!E||o!==t.getAttribute("class"))&&(o==null?t.removeAttribute("class"):e?t.className=o:t.setAttribute("class",o)),t.__className=i}else if(a&&r!==a)for(var d in a){var l=!!a[d];(r==null||l!==!!r[d])&&t.classList.toggle(d,l)}return a}function R(t,e={},i,s){for(var r in i){var a=i[r];e[r]!==a&&(i[r]==null?t.style.removeProperty(r):t.style.setProperty(r,a,s))}}function Tt(t,e,i,s){var r=t.__style;if(E||r!==e){var a=Dt(e,s);(!E||a!==t.getAttribute("style"))&&(a==null?t.removeAttribute("style"):t.style.cssText=a),t.__style=e}else s&&(Array.isArray(s)?(R(t,i==null?void 0:i[0],s[0]),R(t,i==null?void 0:i[1],s[1],"important")):R(t,i,s));return s}function z(t,e,i=!1){if(t.multiple){if(e==null)return;if(!ot(e))return lt();for(var s of t.options)s.selected=e.includes(X(s));return}for(s of t.options){var r=X(s);if(ct(r,e)){s.selected=!0;return}}(!i||e!==void 0)&&(t.selectedIndex=-1)}function Rt(t){var e=new MutationObserver(()=>{z(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ut(()=>{e.disconnect()})}function X(t){return"__value"in t?t.__value:t.value}const C=Symbol("class"),L=Symbol("style"),x=Symbol("is custom element"),tt=Symbol("is html");function ae(t){if(E){var e=!1,i=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var s=t.value;O(t,"value",null),t.value=s}if(t.hasAttribute("checked")){var r=t.checked;O(t,"checked",null),t.checked=r}}};t.__on_r=i,gt(i),_t()}}function ne(t,e){var i=$(t);i.value===(i.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Nt(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function O(t,e,i,s){var r=$(t);E&&(r[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||r[e]!==(r[e]=i)&&(e==="loading"&&(t[Et]=i),i==null?t.removeAttribute(e):typeof i!="string"&&et(t).includes(e)?t[e]=i:t.setAttribute(e,i))}function Pt(t,e,i,s,r=!1){var a=$(t),n=a[x],o=!a[tt];let d=E&&n;d&&V(!1);var l=e||{},g=t.tagName==="OPTION";for(var h in e)h in i||(i[h]=null);i.class?i.class=Ut(i.class):i[C]&&(i.class=null),i[L]&&(i.style??(i.style=null));var u=et(t);for(const c in i){let f=i[c];if(g&&c==="value"&&f==null){t.value=t.__value="",l[c]=f;continue}if(c==="class"){var A=t.namespaceURI==="http://www.w3.org/1999/xhtml";Ot(t,A,f,s,e==null?void 0:e[C],i[C]),l[c]=f,l[C]=i[C];continue}if(c==="style"){Tt(t,f,e==null?void 0:e[L],i[L]),l[c]=f,l[L]=i[L];continue}var m=l[c];if(!(f===m&&!(f===void 0&&t.hasAttribute(c)))){l[c]=f;var p=c[0]+c[1];if(p!=="$$")if(p==="on"){const _={},M="$$"+c;let b=c.slice(2);var F=Ft(b);if(mt(b)&&(b=b.slice(0,-7),_.capture=!0),!F&&m){if(f!=null)continue;t.removeEventListener(b,l[M],_),l[M]=null}if(f!=null)if(F)t[`__${b}`]=f,At([b]);else{let st=function(rt){l[c].call(this,rt)};l[M]=wt(b,t,st,_)}else F&&(t[`__${b}`]=void 0)}else if(c==="style")O(t,c,f);else if(c==="autofocus")yt(t,!!f);else if(!n&&(c==="__value"||c==="value"&&f!=null))t.value=t.__value=f;else if(c==="selected"&&g)Nt(t,f);else{var v=c;o||(v=St(v));var k=v==="defaultValue"||v==="defaultChecked";if(f==null&&!n&&!k)if(a[c]=null,v==="value"||v==="checked"){let _=t;const M=e===void 0;if(v==="value"){let b=_.defaultValue;_.removeAttribute(v),_.defaultValue=b,_.value=_.__value=M?b:null}else{let b=_.defaultChecked;_.removeAttribute(v),_.defaultChecked=b,_.checked=M?b:!1}}else t.removeAttribute(c);else k||u.includes(v)&&(n||typeof f!="string")?(t[v]=f,v in a&&(a[v]=Bt)):typeof f!="function"&&O(t,v,f)}}}return d&&V(!0),l}function oe(t,e,i=[],s=[],r,a=!1){ht(i,s,n=>{var o=void 0,d={},l=t.nodeName==="SELECT",g=!1;if(J(()=>{var u=e(...n.map(vt)),A=Pt(t,o,u,r,a);g&&l&&"value"in u&&z(t,u.value);for(let p of Object.getOwnPropertySymbols(d))u[p]||P(d[p]);for(let p of Object.getOwnPropertySymbols(u)){var m=u[p];p.description===bt&&(!o||m!==o[p])&&(d[p]&&P(d[p]),d[p]=K(()=>Lt(t,()=>m))),A[p]=m}o=A}),l){var h=t;W(()=>{z(h,o.value,!0),Rt(h)})}g=!0})}function $(t){return t.__attributes??(t.__attributes={[x]:t.nodeName.includes("-"),[tt]:t.namespaceURI===ft})}var Y=new Map;function et(t){var e=Y.get(t.nodeName);if(e)return e;Y.set(t.nodeName,e=[]);for(var i,s=t,r=Element.prototype;r!==s;){i=pt(s);for(var a in i)i[a].set&&e.push(a);s=dt(s)}return e}const zt=()=>performance.now(),w={tick:t=>requestAnimationFrame(t),now:()=>zt(),tasks:new Set};function it(){const t=w.now();w.tasks.forEach(e=>{e.c(t)||(w.tasks.delete(e),e.f())}),w.tasks.size!==0&&w.tick(it)}function le(t){let e;return w.tasks.size===0&&w.tick(it),{promise:new Promise(i=>{w.tasks.add(e={c:t,f:i})}),abort(){w.tasks.delete(e)}}}const jt={isGloballyMuted:!0,playingState:"paused",currentSong:null,globalVolume:1},I=Mt(jt),ce={setMuted:t=>{I.update(e=>({...e,isGloballyMuted:t}))},setPlayingState:t=>{I.update(e=>({...e,playingState:t}))},setCurrentSong:t=>{I.update(e=>({...e,currentSong:t}))},setVolume:t=>{I.update(e=>({...e,globalVolume:Math.max(0,Math.min(1,t))}))}},Gt=""+new URL("../assets/250812_Drone 1_seamless.Bles6v51.mp3",import.meta.url).href,$t=""+new URL("../assets/250812_Drone 2_seamless.DNgxXvGE.mp3",import.meta.url).href,Vt=""+new URL("../assets/Blip_hi_00001.CzfUbRJ6.mp3",import.meta.url).href,qt=""+new URL("../assets/Blip_hi_00002.BQSAlaYX.mp3",import.meta.url).href,Qt=""+new URL("../assets/Blip_hi_00003.Di2EzxCf.mp3",import.meta.url).href,Xt=""+new URL("../assets/Blip_hi_00004.ywAQhkrX.mp3",import.meta.url).href,Yt=""+new URL("../assets/Blip_low_00001.CPMgldSK.mp3",import.meta.url).href,Ht=""+new URL("../assets/Blip_low_00002.BPcftkO5.mp3",import.meta.url).href,Jt=""+new URL("../assets/Blip_low_00003.CCXPx8Vk.mp3",import.meta.url).href,Kt=""+new URL("../assets/Blip_low_00004.BDWLfiic.mp3",import.meta.url).href,Wt=""+new URL("../assets/Blip_mid_00001.BhEVpUhi.mp3",import.meta.url).href,Zt=""+new URL("../assets/Blip_mid_00002.k1Ggej5V.mp3",import.meta.url).href,xt=""+new URL("../assets/Blip_mid_00003.BA1yGgJ8.mp3",import.meta.url).href,te=""+new URL("../assets/Blip_mid_00004.l-DazQKu.mp3",import.meta.url).href,ee=""+new URL("../assets/Blip_UI_click.z3NQvCDz.mp3",import.meta.url).href,D=[{title:"Drone1",src:Gt,type:"song"},{title:"Drone2",src:$t,type:"song"},{title:"Blip_hi_00001",src:Vt,type:"cluster"},{title:"Blip_hi_00002",src:qt,type:"cluster"},{title:"Blip_hi_00003",src:Qt,type:"cluster"},{title:"Blip_hi_00004",src:Xt,type:"cluster"},{title:"Blip_low_00001",src:Yt,type:"cluster"},{title:"Blip_low_00002",src:Ht,type:"cluster"},{title:"Blip_low_00003",src:Jt,type:"cluster"},{title:"Blip_low_00004",src:Kt,type:"cluster"},{title:"Blip_mid_00001",src:Wt,type:"cluster"},{title:"Blip_mid_00002",src:Zt,type:"cluster"},{title:"Blip_mid_00003",src:xt,type:"cluster"},{title:"Blip_mid_00004",src:te,type:"cluster"},{title:"Blip_UI",src:ee,type:"ui"}];class ie{constructor(){y(this,"activeFades",new Map)}async fadeTo(e,i,s={}){const{duration:r=500,onComplete:a}=s;this.cancelFade(e),isFinite(i)||(console.warn("Invalid target volume:",i,"defaulting to 0"),i=0),(!isFinite(r)||r<=0)&&(console.warn("Invalid duration:",r,"defaulting to 500"),s.duration=500),i=Math.max(0,Math.min(1,i));const n=isFinite(e.volume)?e.volume:0,o=i-n;if(Math.abs(o)<.001){a==null||a();return}const d=performance.now();return new Promise(l=>{const g=u=>{const A=u-d,m=Math.min(A/r,1);let p;i>n?p=Math.pow(m,.5):p=1-Math.pow(1-m,2);const F=n+o*p,v=Math.max(0,Math.min(1,isFinite(F)?F:0));if(e.volume=v,m<1){const k=requestAnimationFrame(g);this.activeFades.set(e,k)}else e.volume=i,this.activeFades.delete(e),a==null||a(),l()},h=requestAnimationFrame(g);this.activeFades.set(e,h)})}async fadeIn(e,i=.3,s=500){return isFinite(i)||(i=.3),(!isFinite(s)||s<=0)&&(s=500),e.volume=0,this.fadeTo(e,i,{duration:s})}async fadeOut(e,i=500){return(!isFinite(i)||i<=0)&&(i=500),this.fadeTo(e,0,{duration:i,onComplete:()=>{e.pause()}})}cancelFade(e){const i=this.activeFades.get(e);i&&(cancelAnimationFrame(i),this.activeFades.delete(e))}cancelAllFades(){this.activeFades.forEach(e=>{cancelAnimationFrame(e)}),this.activeFades.clear()}}const N=new ie,S=class S{constructor(){y(this,"audioContext",null);y(this,"isAudioEnabled",!1)}static getInstance(){return S.instance||(S.instance=new S),S.instance}isMobileDevice(){return typeof window>"u"?!1:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||!!navigator.maxTouchPoints&&navigator.maxTouchPoints>2}isAudioContextReady(){var e;return this.isAudioEnabled&&((e=this.audioContext)==null?void 0:e.state)==="running"}async enableAudio(){try{return this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.audioContext.state==="suspended"&&await this.audioContext.resume(),this.isAudioEnabled=!0,this.audioContext.state==="running"}catch(e){return console.warn("Failed to enable audio context:",e),!1}}getOptimizedFadeDuration(e,i=!1){return this.isMobileDevice()?i?Math.max(100,e*.2):Math.max(200,e*.4):e}prepareAudioElement(e){this.isMobileDevice()&&(e.preload="metadata",e.addEventListener("canplaythrough",()=>{},{once:!0}),e.addEventListener("stalled",()=>{console.warn("Audio stalled on mobile, attempting to continue...")}))}supportsMultipleAudioStreams(){return!this.isMobileDevice()}};y(S,"instance");let j=S;const U=j.getInstance(),ue=()=>U.isMobileDevice(),B=class B{constructor(){y(this,"soundCache",new Map);y(this,"playingSounds",new Set)}static getInstance(){return B.instance||(B.instance=new B),B.instance}async playEffect(e,i){const s=Ct(I);if(!s.isGloballyMuted)try{let r;const a=D.findIndex(l=>l.title===e);a!==-1?r=D[a].src:r=e;let n=this.soundCache.get(e);n||(n=new Audio(r),n.preload="auto",U.prepareAudioElement(n),this.soundCache.set(e,n));const o=i!==void 0?i:s.globalVolume;n.currentTime=0,this.playingSounds.add(n),n.addEventListener("ended",()=>{this.playingSounds.delete(n)},{once:!0}),n.volume=0,await n.play();const d=U.getOptimizedFadeDuration(H*.3);await N.fadeIn(n,o,d)}catch(r){console.warn("Failed to play sound effect:",r)}}async stopEffect(e){const i=this.soundCache.get(e);if(i&&this.playingSounds.has(i)){const s=U.getOptimizedFadeDuration(H*.2,!0);await N.fadeOut(i,s),i.currentTime=0,this.playingSounds.delete(i)}}stopAllEffects(){this.playingSounds.forEach(e=>{N.cancelFade(e),e.pause(),e.currentTime=0}),this.playingSounds.clear()}preloadSounds(e){e.forEach(i=>{const s=D.findIndex(r=>r.title===i);if(s!==-1){const r=new Audio(D[s].src);r.preload="auto",U.prepareAudioElement(r),this.soundCache.set(i,r)}})}clearCache(){this.stopAllEffects(),this.soundCache.forEach(e=>{e.pause(),e.src=""}),this.soundCache.clear()}};y(B,"instance");let G=B;const fe=G.getInstance();let H=500;export{O as a,fe as b,oe as c,It as d,ae as e,ne as f,Ot as g,I as h,ue as i,ce as j,N as k,le as l,U as m,w as r,Tt as s,D as t};
