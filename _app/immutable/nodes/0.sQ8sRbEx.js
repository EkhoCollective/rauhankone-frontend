import{f as K,a as S,e as D,t as A,b as R,d as Z,s as W,i as Pe}from"../chunks/H1z1FJes.js";import{b as be,h as P,a as ke,aO as le,f as we,g as je,s as Ne,i as ie,U as B,ag as F,w as ce,c as M,q as Oe,d as ye,aA as de,az as ue,aP as ve,aL as Ce,j as fe,p as q,T as Me,z as _e,a0 as Le,aQ as qe,aR as Re,R as V,J as z,K as h,O as v,Q as I,M as J,N as G,m as l,X as pe,v as T,Z as x,aS as De,Y as Ve}from"../chunks/Dh_q_AIo.js";import{i as ee}from"../chunks/BNMlPN2X.js";import{X as ze,a as me,s as Ge,t as He,b as N,A as Ue,C as Qe,c as Fe}from"../chunks/Bkcly0ER.js";import{I as ae,s as te,c as Ye,i as Xe,t as j,b as Ze,e as he,a as Be,f as O}from"../chunks/Cdh1kfaN.js";import{_ as H}from"../chunks/Dp1pzeXC.js";import{r as U,b as Se,g as Je,$ as Te,a as ge,w as Ae}from"../chunks/C370JjdC.js";import{p as oe}from"../chunks/DHCc2Xta.js";import{c as Ke}from"../chunks/DKHGB5Zl.js";import{l as ne,s as se,p as We}from"../chunks/CvJ11vW7.js";import{C as ea}from"../chunks/0T1KAf38.js";import{b as Ie,g as aa}from"../chunks/CCZFzJQC.js";const Y=0,C=1,X=2;function ta(s,e,o,g,i){P&&ke();var a=s,r=Le(),d=Ce,t=B,u,f,k,_=(r?ce:_e)(void 0),p=(r?ce:_e)(void 0),$=!1;function b(m,n){$=!0,n&&(de(L),ue(L),ve(d));try{m===Y&&o&&(u?fe(u):u=M(()=>o(a))),m===C&&g&&(f?fe(f):f=M(()=>g(a,_))),m!==Y&&u&&q(u,()=>u=null),m!==C&&f&&q(f,()=>f=null),m!==X&&k&&q(k,()=>k=null)}finally{n&&(ve(null),ue(null),de(null),Me())}}var L=be(()=>{if(t===(t=e()))return;let m=P&&le(t)===(a.data===we);if(m&&(a=je(),Ne(a),ie(!1),m=!0),le(t)){var n=t;$=!1,n.then(c=>{n===t&&(F(_,c),b(C,!0))},c=>{if(n===t)throw F(p,c),b(X,!0),p.v}),P?o&&(u=M(()=>o(a))):Oe(()=>{$||b(Y,!0)})}else F(_,t),b(C,!1);return m&&ie(!0),()=>t=B});P&&(a=ye)}function oa(s,e,o){P&&ke();var g=s,i=B,a,r=Le()?qe:Re;be(()=>{r(i,i=e())&&(a&&q(a),a=M(()=>o(g)))}),P&&(g=ye)}const na=!0,Da=Object.freeze(Object.defineProperty({__proto__:null,prerender:na},Symbol.toStringTag,{value:"Module"})),$e="en";U("en",()=>H(()=>import("../chunks/ICEdU12j.js"),[],import.meta.url));U("fi",()=>H(()=>import("../chunks/CH3oJwPu.js"),[],import.meta.url));U("sv",()=>H(()=>import("../chunks/D2SZLOoF.js"),[],import.meta.url));U("sa",()=>H(()=>import("../chunks/DS1uFp8_.js"),[],import.meta.url));Se({fallbackLocale:$e,initialLocale:Je()||$e});async function sa(){try{const e=await fetch("https://peacemachine.eu/auth/app-token",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Error ${e.status}: ${await e.text()}`);const o=await e.json();return localStorage.setItem("accessToken",o.access_token),localStorage.setItem("refreshToken",o.refresh_token),o}catch(s){return console.error("Error getting auth token:",s),null}}function ra(s,e){const o=ne(e,["children","$$slots","$$events","$$legacy"]);ae(s,se({name:"globe"},()=>o,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}],["path",{d:"M2 12h20"}]],children:(i,a)=>{var r=K(),d=V(r);te(d,e,"default",{}),S(i,r)},$$slots:{default:!0}}))}function la(s,e){const o=ne(e,["children","$$slots","$$events","$$legacy"]);ae(s,se({name:"volume-2"},()=>o,{iconNode:[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"}],["path",{d:"M16 9a5 5 0 0 1 0 6"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728"}]],children:(i,a)=>{var r=K(),d=V(r);te(d,e,"default",{}),S(i,r)},$$slots:{default:!0}}))}function ia(s,e){const o=ne(e,["children","$$slots","$$events","$$legacy"]);ae(s,se({name:"volume-x"},()=>o,{iconNode:[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15"}]],children:(i,a)=>{var r=K(),d=V(r);te(d,e,"default",{}),S(i,r)},$$slots:{default:!0}}))}var ca=(s,e)=>e.closeLangCard(),da=(s,e,o)=>e(o()),ua=A("<button> </button>"),va=A('<div class="card-lang-container svelte-dj9995"><div class="card-header-container svelte-dj9995"><button class="btn btn-close svelte-dj9995"><!></button></div> <div class="card-btn-container svelte-dj9995"></div> <div class="card-extra-container svelte-dj9995"><div class="card-checkmark-container svelte-dj9995"><!></div> <div> </div></div></div>');function fa(s,e){z(e,!0);const[o,g]=W(),i=()=>R(ge,"$locale",o),a=()=>R(Te,"$_",o);let r=We(e,"translate",15);const d=[{code:"en",name:"English"},{code:"fi",name:"Suomi"},{code:"sv",name:"Svenska"},{code:"sa",name:"SÃ¡megiella"}];async function t(c){ge.set(c),localStorage.setItem("locale",c),await Ae().then(()=>{e.closeLangCard(!1)})}var u=va(),f=h(u),k=h(f);k.__click=[ca,e];var _=h(k);ze(_,{color:"#ffffff"}),v(k),v(f);var p=I(f,2);Ye(p,21,()=>d,Xe,(c,y)=>{let E=()=>l(y).code,Q=()=>l(y).name;var w=ua();let re;w.__click=[da,t,E];var xe=h(w,!0);v(w),J(Ee=>{re=Ke(w,1,"btn btn-lang svelte-dj9995",null,re,Ee),Z(xe,Q())},[()=>({"active-lang":i()===E()})]),S(c,w)}),v(p);var $=I(p,2),b=h($),L=h(b);ea(L,{get checkValue(){return r()},set checkValue(c){r(c)}}),v(b);var m=I(b,2),n=h(m,!0);v(m),v($),v(u),J(c=>Z(n,c),[()=>a()("btn_translate_check")]),S(s,u),G(),g()}D(["click"]);D(["click"]);var _a=(s,e)=>e(),pa=A('<div class="audio-icon-container svelte-1hhaios"><button class="btn svelte-1hhaios"><!></button></div>');function ma(s,e){z(e,!0);const[o,g]=W(),i=()=>R(me,"$audioStore",o);let a=x(0),r=x(-1),d=x("paused"),t=x(null);function u(){me.update(n=>{const c=!n.isGloballyMuted;return c?(l(t)&&l(t).pause(),Ge.stopAllEffects(),T(d,"paused")):l(d)==="paused"&&k(),{...n,isGloballyMuted:c}})}function f(){l(t)&&(l(t).pause(),T(t,null)),T(t,new Audio(He[l(a)].src),!0),l(t).volume=.3,l(t).loop=!0,l(t).play(),T(r,l(a),!0),N.setCurrentSong(l(t)),N.setVolume(.3)}function k(){l(d)==="playing"&&_(),T(d,"playing"),N.setPlayingState("playing"),f()}function _(){var n;T(d,"paused"),N.setPlayingState("paused"),(n=l(t))==null||n.pause()}pe(()=>{oe.url.pathname==="/explore"?T(a,1):T(a,0)}),pe(()=>{l(d)==="playing"&&l(a)!==l(r)&&f()});var p=pa(),$=h(p);$.__click=[_a,u];var b=h($);{var L=n=>{ia(n,{color:"#ffffff"})},m=n=>{la(n,{color:"#ffffff"})};ee(b,n=>{i().isGloballyMuted?n(L):n(m,!1)})}v($),v(p),S(s,p),G(),g()}D(["click"]);var ha=()=>aa(`${Ie}/`),ga=A('<div class="back-btn-container svelte-1sj945"><button class="btn svelte-1sj945"><!> </button></div>'),$a=(s,e)=>e.toggleLang(),ba=A('<div class="card-header-container svelte-1sj945"><!> <div class="lang-btn-container svelte-1sj945"><button class="btn svelte-1sj945"><!></button></div> <div class="audio-control-container svelte-1sj945"><!></div></div>');function ka(s,e){z(e,!0);const[o,g]=W(),i=()=>R(Te,"$_",o);var a=ba(),r=h(a);{var d=p=>{var $=ga(),b=h($);b.__click=[ha];var L=h(b);Ue(L,{color:"#ffffff"});var m=I(L);v(b),v($),J(n=>Z(m,` ${n??""}`),[()=>i()("btn_exit")]),j(3,$,()=>Ze),S(p,$)};ee(r,p=>{oe.url.pathname===`${Ie}/explore`&&p(d)})}var t=I(r,2),u=h(t);u.__click=[$a,e];var f=h(u);ra(f,{color:"#ffffff"}),v(u),v(t);var k=I(t,2),_=h(k);ma(_,{}),v(k),v(a),S(s,a),G(),g()}D(["click"]);var ya=A('<link rel="icon" type="image/svg" href="/favicon.ico">'),La=A('<div class="lang-container svelte-eqtc25"><!></div>'),Sa=A('<div class="page-container"><!></div>'),Ta=A('<!> <div class="header-container svelte-eqtc25"><!></div> <!>',1),Aa=A('<div class="app svelte-eqtc25"><!></div>');function Va(s,e){z(e,!0);let o=x(null),g=x(!1),i=500,a=x(!1);De("questions",()=>l(o)),Se({fallbackLocale:"en",initialLocale:"en"});const r=()=>({API_ENDPOINT:"/get_questions",API_METHOD:"POST",REQUEST_BODY:{question_type:"starter"}});async function d(){await sa().then(()=>{t()}).catch(_=>{throw he(500,"Failed to get token")})}async function t(){await Be(r()).then(_=>{T(o,_,!0)}).catch(_=>{throw he(500,"Failed to get questions")})}let u=()=>{T(g,!l(g))};Ve(()=>{window.scrollTo(0,0),d()});var f=Aa();Pe(_=>{var p=ya();S(_,p)});var k=h(f);ta(k,Ae,_=>{Qe(_)},_=>{var p=Ta(),$=V(p);{var b=c=>{var y=La(),E=h(y);fa(E,{closeLangCard:u,get translate(){return l(a)},set translate(Q){T(a,Q,!0)}}),v(y),j(1,y,()=>O,()=>({duration:i})),j(2,y,()=>O,()=>({duration:i})),S(c,y)};ee($,c=>{l(g)&&c(b)})}var L=I($,2),m=h(L);ka(m,{toggleLang:u}),v(L);var n=I(L,2);oa(n,()=>oe.url.pathname,c=>{var y=Sa(),E=h(y);Fe(E,()=>e.children),v(y),j(1,y,()=>O,()=>({duration:i})),j(2,y,()=>O,()=>({duration:i})),S(c,y)}),S(_,p)}),v(f),S(s,f),G()}export{Va as component,Da as universal};
